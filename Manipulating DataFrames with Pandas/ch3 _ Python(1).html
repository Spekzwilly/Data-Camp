<!doctype html>
<html lang="en" data-reactroot="" data-reactid="1" data-react-checksum="625539415"><head data-reactid="2"><title data-reactid="3">Stacking &amp; unstacking I | Python</title><meta charset="utf-8" data-reactid="4"/><!-- react-text: 5 --><!-- /react-text --><meta name="robots" content="noindex" data-reactid="6"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" data-reactid="7"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" data-reactid="8"/><meta name="fragment" content="!" data-reactid="9"/><meta name="keywords" content="R, Python, Data analysis, interactive, learning" data-reactid="10"/><meta name="description" content="Here is an example of Stacking &amp; unstacking I: You are now going to practice stacking and unstacking DataFrames." data-reactid="11"/><meta name="twitter:card" content="summary" data-reactid="12"/><meta name="twitter:site" content="@DataCamp" data-reactid="13"/><meta name="twitter:title" content="Stacking &amp; unstacking I | Python" data-reactid="14"/><meta name="twitter:description" content="Here is an example of Stacking &amp; unstacking I: You are now going to practice stacking and unstacking DataFrames." data-reactid="15"/><meta name="twitter:creator" content="@DataCamp" data-reactid="16"/><meta name="twitter:image:src" content="/public/assets/images/var/images/var/twitter_share.png" data-reactid="17"/><meta name="twitter:domain" content="www.datacamp.com" data-reactid="18"/><meta property="og:title" content="Stacking &amp; unstacking I | Python" data-reactid="19"/><meta property="og:image" content="/public/assets/images/var/linkedin_share.png" data-reactid="20"/><meta name="google-signin-clientid" content="892114885437-01a7plbsu1b2vobuhvnckmmanhb58h3a.apps.googleusercontent.com" data-reactid="21"/><meta name="google-signin-scope" content="email profile" data-reactid="22"/><meta name="google-signin-cookiepolicy" content="single_host_origin" data-reactid="23"/><link rel="icon" type="image/png" href="/public/assets/images/favicon.ico" data-reactid="24"/><link href="/public/assets/images/apple-icon.png" rel="apple-touch-icon" data-reactid="25"/><link href="/public/assets/images/apple-icon.png" rel="apple-touch-icon-precomposed" data-reactid="26"/><link rel="stylesheet" href="/public/style-a782c66d376818db12b277e0fc2376d7.css" data-reactid="27"/><script src="//use.typekit.net/pjc4zfc.js" data-reactid="28"></script><script charset="UTF-8" data-reactid="29">try{Typekit.load();}catch(e){}</script></head><body data-reactid="30"><div id="root" data-reactid="31"><div class="theme progress-indicator--visible theme--light" data-reactroot="" data-reactid="1" data-react-checksum="-1216365769"><header class="dc-header-campus" data-reactid="2"><a href="https://www.datacamp.com/" class="dc-header-campus__home" data-reactid="3"><div class="dc-header-campus__logo" data-reactid="4"></div><p class="dc-header-campus__title" data-reactid="5">DataCamp</p></a><div class="dc-nav-course__container" data-reactid="6"><div class="__react_component_tooltip place-top type-dark " data-id="tooltip" data-reactid="7"></div><div class="__react_component_tooltip place-top type-dark " data-id="tooltip" data-reactid="8"></div><div class="__react_component_tooltip place-top type-dark " data-id="tooltip" data-reactid="9"></div><nav class="dc-nav-course" data-onboarding="course-navigation" data-reactid="10"><a class="dc-nav-course__backward" data-tip="true" data-for="nav-tp-prev" href="/courses/manipulating-dataframes-with-pandas/rearranging-and-reshaping-data?ex=5" data-reactid="11"><i class="fa fa-arrow-left dc-nav-course__icon" data-reactid="12"></i></a><a class="dc-nav-course__outline" data-tip="true" data-for="nav-tp-outline" href="" data-reactid="13"><i class="fa fa-lg fa-bars dc-nav-course__icon" data-reactid="14"></i><!-- react-text: 15 -->Course Outline<!-- /react-text --></a><a class="dc-nav-course__forward" data-tip="true" data-for="nav-tp-next" href="/courses/manipulating-dataframes-with-pandas/rearranging-and-reshaping-data?ex=7" data-reactid="16"><i class="fa fa-arrow-right dc-nav-course__icon" data-reactid="17"></i></a></nav></div><nav class="dc-nav-campus" data-reactid="18"><div class="app-status" id="app-status" data-reactid="19"><div class="hcSlide-wrapper" data-reactid="20"><!-- react-empty: 21 --></div><i class="fa fa-circle" data-reactid="22"></i></div><a class="ds-icon-action" href="" data-reactid="23"><div data-tip="true" data-for="tp-notifications" data-reactid="24"><div class="__react_component_tooltip place-top type-dark " data-id="tooltip" data-reactid="25"></div><i class="fa fa-bell" data-reactid="26"></i></div></a><a class="ds-icon-action" href="" data-reactid="27"><div data-tip="true" data-for="tp-slides" data-reactid="28"><div class="__react_component_tooltip place-top type-dark " data-id="tooltip" data-reactid="29"></div><i class="fa fa-file-pdf-o hover-icon" data-reactid="30"></i></div></a><a class="ds-icon-action" data-test-id="header-report-issue-button" href="" data-reactid="31"><div data-tip="true" data-for="tp-issue" data-reactid="32"><div class="__react_component_tooltip place-top type-dark " data-id="tooltip" data-reactid="33"></div><i class="fa fa-exclamation-circle" aria-hidden="true" data-reactid="34"></i></div></a></nav></header><div class="exercise-area " data-reactid="35"><div data-reactid="36"><aside class="exercise--sidebar" style="width:40%;" data-reactid="37"><div class="exercise--sidebar-content" data-reactid="38"><div class="listview__outer" data-reactid="39"><div class="listview__inner" data-reactid="40"><div class="listview__section" data-onboarding="assignment" data-reactid="41"><div data-reactid="42"><div role="button" class="listview__header" data-reactid="43"><div class="exercise--sidebar-header" data-reactid="44"><h5 class="dc-panel__title" data-reactid="45"><i class="fa fa-list-alt u-spacing-r1" data-reactid="46"></i><!-- react-text: 47 -->Exercise<!-- /react-text --></h5></div></div></div><div class="listview__content" data-reactid="48"><div class="exercise--assignment exercise--typography" data-reactid="49"><h1 class="exercise--title" data-reactid="50">Stacking &amp; unstacking I</h1><div data-reactid="51"><div data-reactid="52"><p>You are now going to practice stacking and unstacking DataFrames. The <code>users</code> DataFrame you have been working with in this chapter has been pre-loaded for you, this time with a MultiIndex. Explore it in the IPython Shell to see the data layout. Pay attention to the index, and notice that the index levels are <code>['city', 'weekday']</code>. So <code>'weekday'</code> - the second entry - has position 1. This position is what corresponds to the <code>level</code> parameter in <code>.stack()</code> and <code>.unstack()</code> calls. Alternatively, you can specify <code>'weekday'</code> as the level instead of its position.</p>
<p>Your job in this exercise is to unstack <code>users</code> by <code>'weekday'</code>. You will then use <code>.stack()</code> on the unstacked DataFrame to see if you get back the original layout of <code>users</code>.</p></div></div></div></div></div><div class="listview__section" style="min-height:calc(100% - 31px);" data-onboarding="instructions" data-reactid="53"><div data-reactid="54"><div role="button" class="listview__header" data-reactid="55"><div class="exercise--sidebar-header" data-reactid="56"><h5 class="dc-panel__title" data-reactid="57"><i class="fa fa-check-circle-o u-spacing-r1" data-reactid="58"></i><!-- react-text: 59 -->Instructions<!-- /react-text --></h5><span class="tag tag--xp" data-reactid="60"><!-- react-text: 61 -->100<!-- /react-text --><!-- react-text: 62 --> XP<!-- /react-text --></span></div></div></div><div class="listview__content" data-reactid="63"><div data-reactid="64"><div class="" data-reactid="65"><div data-onboarding="instructions" class="exercise--instructions exercise--typography" data-reactid="66"><div data-reactid="67"><div class="exercise--instructions__content" data-reactid="68"><ul>
<li>Define a DataFrame <code>byweekday</code> with the <code>'weekday'</code> level of <code>users</code> unstacked.</li>
<li>Print the <code>byweekday</code> DataFrame to see the new data layout. This has been done for you.</li>
<li>Stack <code>byweekday</code> by <code>'weekday'</code> and print it to check if you get the same layout as the original <code>users</code> DataFrame.</li>
</ul></div></div><div class="sct-feedback" data-reactid="69"><div style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:scroll;z-index:-1;visibility:hidden;" data-reactid="70"><div style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:scroll;z-index:-1;visibility:hidden;" data-reactid="71"><div style="position:absolute;left:0;top:0;width:0;height:0;" data-reactid="72"></div></div><div style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:scroll;z-index:-1;visibility:hidden;" data-reactid="73"><div style="position:absolute;left:0;top:0;width:200%;height:200%;" data-reactid="74"></div></div></div><ul class="content--tab mono" data-reactid="75"><div style="display:inline-block;" data-tip="true" data-for="tp-hint" data-reactid="76"><div class="__react_component_tooltip place-top type-dark " data-id="tooltip" data-reactid="77"></div><a class="exercise--show-hint" href="" data-reactid="78"><i class="fa fa-lightbulb-o" data-reactid="79"></i><span data-reactid="80"><!-- react-text: 81 -->Take Hint<!-- /react-text --><!-- react-text: 82 --> (-<!-- /react-text --><!-- react-text: 83 -->30<!-- /react-text --><!-- react-text: 84 --> XP)<!-- /react-text --></span></a></div></ul></div></div></div></div></div></div></div></div></div></aside><section class="exercise--content" style="width:60%;" data-reactid="85"><div class="exercise-waiting" data-reactid="86"><div class="global-spinner" data-reactid="87"><object type="image/svg+xml" data="/public/assets/images/spinner.svg" aria-label="Loading" data-reactid="88"></object></div><noscript data-reactid="89"></noscript></div></section></div><!-- react-empty: 90 --><div class="toastify toastify--top-right" style="pointer-events:none;" data-reactid="91"><span data-reactid="92"></span></div></div><div class="exercise-footer" data-reactid="93"><ul class="dc-progress-indicator" data-reactid="94"><li class="dc-progress-indicator__item" data-reactid="95"><a class="dc-progress-indicator__bar" data-reactid="96"><div class="dc-progress-indicator__fill" style="width:0%;" data-reactid="97"></div></a></li><li class="dc-progress-indicator__item" data-reactid="98"><a class="dc-progress-indicator__bar" data-reactid="99"><div class="dc-progress-indicator__fill" style="width:0%;" data-reactid="100"></div></a></li><li class="dc-progress-indicator__item" data-reactid="101"><a class="dc-progress-indicator__bar" data-reactid="102"><div class="dc-progress-indicator__fill" style="width:0%;" data-reactid="103"></div></a></li><li class="dc-progress-indicator__item" data-reactid="104"><a class="dc-progress-indicator__bar" data-reactid="105"><div class="dc-progress-indicator__fill" style="width:0%;" data-reactid="106"></div></a></li><li class="dc-progress-indicator__item" data-reactid="107"><a class="dc-progress-indicator__bar" data-reactid="108"><div class="dc-progress-indicator__fill" style="width:0%;" data-reactid="109"></div></a></li></ul></div><!-- react-empty: 110 --><!-- react-empty: 111 --></div></div><script data-reactid="32">
            window.env= "production";
            window.release = "v1.12.1";
          </script><script charset="UTF-8" data-reactid="33">window.PRELOADED_STATE={"systemStatus":{"indicator":"none","description":"No status has been fetched from the Status Page."},"backendSession":{"status":{"code":"none","text":""},"isInitSession":false,"message":null},"settings":{"uiTheme":"LIGHT","isOnboarding":false},"autocomplete":{},"user":{"settings":{}},"fileBrowser":{"isVisible":true,"fileSelected":null},"chapter":{"current":{"badge_uncompleted_url":"https://assets.datacamp.com/production/default/badges/missing_unc.png","number":3,"slug":"rearranging-and-reshaping-data","last_updated_on":"11/06/2018","title_meta":null,"nb_exercises":16,"free_preview":null,"slides_link":"https://s3.amazonaws.com/assets.datacamp.com/production/course_2566/slides/ch3_slides.pdf","title":"Rearranging and reshaping data","xp":1350,"id":4299,"description":"Here, you will learn how to reshape your DataFrames using techniques such as pivoting, melting, stacking, and unstacking. These are powerful techniques that allow you to tidy and rearrange your data into the format that allows you to most easily analyze it for insights.","badge_completed_url":"https://assets.datacamp.com/production/default/badges/missing.png"}},"ltiChecker":{"isFetching":false,"isValid":true},"location":{"current":{"pathname":"/courses/manipulating-dataframes-with-pandas/rearranging-and-reshaping-data","query":{"ex":6},"host":"campus-origin.new.datacamp.com"},"backendSession":null,"settings":null,"user":null},"course":{"difficulty_level":2,"reduced_outline":null,"shared_image":"shared-python:d7d09efd34349262635364e82eb55bc4-20180628071430927","active_image":"course-1650-master:924c2bd1594905a26e059ee8cabf5136-20180613004540744","author_field":null,"chapters":[{"badge_uncompleted_url":"https://assets.datacamp.com/production/default/badges/missing_unc.png","number":1,"slug":"extracting-and-transforming-data","last_updated_on":"05/02/2018","title_meta":null,"nb_exercises":16,"free_preview":true,"slides_link":"https://s3.amazonaws.com/assets.datacamp.com/production/course_2566/slides/ch1_slides.pdf","title":"Extracting and transforming data","xp":1350,"id":4297,"description":"In this chapter, you will learn all about how to index, slice, filter, and transform DataFrames, using a variety of datasets, ranging from 2012 US election data for the state of Pennsylvania to Pittsburgh weather data.","badge_completed_url":"https://assets.datacamp.com/production/default/badges/missing.png"},{"badge_uncompleted_url":"https://assets.datacamp.com/production/default/badges/missing_unc.png","number":2,"slug":"advanced-indexing","last_updated_on":"05/02/2018","title_meta":null,"nb_exercises":10,"free_preview":null,"slides_link":"https://s3.amazonaws.com/assets.datacamp.com/production/course_2566/slides/ch2_slides.pdf","title":"Advanced indexing","xp":850,"id":4298,"description":"Having learned the fundamentals of working with DataFrames, you will now move on to more advanced indexing techniques. You will learn about MultiIndexes, or hierarchical indexes, and learn how to interact with and extract data from them.","badge_completed_url":"https://assets.datacamp.com/production/default/badges/missing.png"},{"badge_uncompleted_url":"https://assets.datacamp.com/production/default/badges/missing_unc.png","number":3,"slug":"rearranging-and-reshaping-data","last_updated_on":"11/06/2018","title_meta":null,"nb_exercises":16,"free_preview":null,"slides_link":"https://s3.amazonaws.com/assets.datacamp.com/production/course_2566/slides/ch3_slides.pdf","title":"Rearranging and reshaping data","xp":1350,"id":4299,"description":"Here, you will learn how to reshape your DataFrames using techniques such as pivoting, melting, stacking, and unstacking. These are powerful techniques that allow you to tidy and rearrange your data into the format that allows you to most easily analyze it for insights.","badge_completed_url":"https://assets.datacamp.com/production/default/badges/missing.png"},{"badge_uncompleted_url":"https://assets.datacamp.com/production/default/badges/missing_unc.png","number":4,"slug":"grouping-data","last_updated_on":"11/06/2018","title_meta":null,"nb_exercises":16,"free_preview":null,"slides_link":"https://s3.amazonaws.com/assets.datacamp.com/production/course_2566/slides/ch4_slides.pdf","title":"Grouping data","xp":1350,"id":4300,"description":"In this chapter, you'll learn how to identify and split DataFrames by groups or categories for further aggregation or analysis. You'll also learn how to transform and filter your data, including how to detect outliers and impute missing values. Knowing how to effectively group data in pandas can be a seriously powerful addition to your data science toolbox.","badge_completed_url":"https://assets.datacamp.com/production/default/badges/missing.png"},{"badge_uncompleted_url":"https://assets.datacamp.com/production/default/badges/missing_unc.png","number":5,"slug":"bringing-it-all-together","last_updated_on":"07/06/2018","title_meta":null,"nb_exercises":17,"free_preview":null,"slides_link":"https://s3.amazonaws.com/assets.datacamp.com/production/course_2566/slides/ch5_slides.pdf","title":"Bringing it all together","xp":1400,"id":4301,"description":"Here, you will bring together everything you have learned in this course while working with data recorded from the Summer Olympic games that goes as far back as 1896! This is a rich dataset that will allow you to fully apply the data manipulation techniques you have learned. You will pivot, unstack, group, slice, and reshape your data as you explore this dataset and uncover some truly fascinating insights. Enjoy!","badge_completed_url":"https://assets.datacamp.com/production/default/badges/missing.png"}],"time_needed":"4 hours","author_image":"placeholder.png","runtime_config":null,"lti_only":false,"image_url":"https://assets.datacamp.com/production/course_1650/shields/thumb/shield_image_course_1650_20180606-12-txw58o?1528314283","topic_id":3,"slug":"manipulating-dataframes-with-pandas","last_updated_on":"11/06/2018","paid":true,"university":null,"state":"live","author_bio":null,"should_cache":true,"sharing_links":{"twitter":"http://bit.ly/1eWTMJh","facebook":"http://bit.ly/1iS42Do"},"title":"Manipulating DataFrames with pandas","xp":6300,"image_thumbnail_url":"https://assets.datacamp.com/production/course_1650/shields/thumb_home/shield_image_course_1650_20180606-12-txw58o?1528314283","short_description":"You will learn how to tidy, rearrange, and restructure your data using versatile pandas DataFrames.","nb_of_subscriptions":24755,"type":"datacamp","link":"https://www.datacamp.com/courses/manipulating-dataframes-with-pandas","id":1650,"description":"In this course, you'll learn how to leverage pandas' extremely powerful data manipulation engine to get the most out of your data. It is important to be able to extract, filter, and transform data from DataFrames in order to drill into the data that really matters. The pandas library has many techniques that make this process efficient and intuitive. You will learn how to tidy, rearrange, and restructure your data by pivoting or melting and stacking or unstacking DataFrames. These are all fundamental next steps on the road to becoming a well-rounded Data Scientist, and you will have the chance to apply all the concepts you learn to real-world datasets.","programming_language":"python"},"exercises":{"current":5,"all":[{"sample_code":"","sct":"","aspect_ratio":56.25,"instructions":null,"question":"","hint":null,"possible_answers":[],"number":1,"video_hls":"//videos.datacamp.com/transcoded/1650_pandas-2/v3/hls-ch3_1.master.m3u8","randomNumber":0.8728039960943652,"assignment":null,"feedbacks":[],"attachments":null,"title":"Pivoting DataFrames","xp":50,"language":"python","pre_exercise_code":"","solution":"","type":"VideoExercise","id":44901,"projector_key":"course_1650_43c5a685ce2361d969870d5a772afd11","video_link":null},{"sample_code":"","sct":"","instructions":null,"question":"","hint":"<p>Did Dhavide explicitly mention in the video that you have to set the index?</p>","possible_answers":["True.","[False.]"],"number":2,"randomNumber":0.12251764841198054,"assignment":"<p>Prior to using <code>.pivot()</code>, you need to set the index of the DataFrame somehow. Is this statement True or False?</p>","feedbacks":["Incorrect - Did Dhavide mention in the video that you have to set the index?","Correct!"],"attachments":null,"title":"Pivoting and the index","xp":50,"language":"python","pre_exercise_code":"","solution":"","type":"PureMultipleChoiceExercise","id":44902},{"sample_code":"# Pivot the users DataFrame: visitors_pivot\nvisitors_pivot = ____\n\n# Print the pivoted DataFrame\nprint(visitors_pivot)\n","sct":"test_correct(test_data_frame(\"visitors_pivot\"),\n             test_function(\"users.pivot\"))\n\ntest_function(\"print\")\n\nsuccess_msg(\"Well done! Notice how in the pivoted DataFrame, the index is labeled `'weekday'`, the columns are labeled `'city'`, and the values are populated by the number of visitors.\")\n","instructions":"<ul>\n<li>Pivot the <code>users</code> DataFrame with the rows indexed by <code>'weekday'</code>, the columns indexed by <code>'city'</code>, and the values populated with <code>'visitors'</code>.</li>\n<li>Print the pivoted DataFrame. This has been done for you, so hit 'Submit Answer' to view the result.</li>\n</ul>","question":"","hint":"<p>Use the <code>.pivot()</code> method on <code>users</code> and specify the <code>index</code>, <code>columns</code>, and <code>values</code> parameters.</p>","possible_answers":[],"number":3,"randomNumber":0.9332894467684074,"assignment":"<p>Suppose you started a blog for a band, and you would like to log how many visitors you have had, and how many signed-up for your newsletter. To help design the tours later, you track where the visitors are. A DataFrame called <code>users</code> consisting of this information has been pre-loaded for you.</p>\n<p>Inspect <code>users</code> in the IPython Shell and make a note of which variable you want to use to index the rows (<code>'weekday'</code>), which variable you want to use to index the columns (<code>'city'</code>), and which variable will populate the values in the cells (<code>'visitors'</code>). Try to visualize what the result should be.</p>\n<p>For example, in the video, Dhavide used <code>'treatment'</code> to index the rows, <code>'gender'</code> to index the columns, and <code>'response'</code> to populate the cells. Prior to pivoting, the DataFrame looked like this:</p>\n<pre><code>   id treatment gender  response\n0   1         A      F         5\n1   2         A      M         3\n2   3         B      F         8\n3   4         B      M         9\n</code></pre>\n<p>After pivoting:</p>\n<pre><code>gender     F  M\ntreatment      \nA          5  3\nB          8  9\n</code></pre>\n<p>In this exercise, your job is to pivot <code>users</code> so that the focus is on <code>'visitors'</code>, with the columns indexed by <code>'city'</code> and the rows indexed by <code>'weekday'</code>.</p>","feedbacks":[],"attachments":null,"title":"Pivoting a single variable","xp":100,"language":"python","pre_exercise_code":"import pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename)\nusers = users.drop('Unnamed: 0', 1)","solution":"# Pivot the users DataFrame: visitors_pivot\nvisitors_pivot = users.pivot(index='weekday', columns='city', values='visitors')\n\n# Print the pivoted DataFrame\nprint(visitors_pivot)\n","type":"NormalExercise","id":44903},{"sample_code":"# Pivot users with signups indexed by weekday and city: signups_pivot\nsignups_pivot = ____\n\n# Print signups_pivot\nprint(signups_pivot)\n\n# Pivot users pivoted by both signups and visitors: pivot\npivot = ____\n\n# Print the pivoted DataFrame\nprint(pivot)\n","sct":"test_correct(test_data_frame(\"signups_pivot\"),\n             test_function(\"users.pivot\", index=1))\n\ntest_function(\"print\", index=1)\n\ntest_correct(test_data_frame(\"pivot\"),\n             test_function(\"users.pivot\", index=2))\n\ntest_function(\"print\", index=2)\n\nsuccess_msg(\"Great work! Notice how in the second DataFrame, both `'signups'` and `'visitors'` were pivoted by default since you didn't provide an argument for the `values` parameter.\")\n","instructions":"<ul>\n<li>Pivot the <code>users</code> DataFrame with the <code>'signups'</code> indexed by <code>'weekday'</code> in the rows and <code>'city'</code> in the columns.</li>\n<li>Print the new DataFrame. This has been done for you.</li>\n<li>Pivot the <code>users</code> DataFrame with both <code>'signups'</code> and <code>'visitors'</code> pivoted - that is, all the variables. This will happen automatically if you do not specify an argument for the <code>values</code> parameter of <code>.pivot()</code>.</li>\n<li>Print the pivoted DataFrame. This has been done for you, so hit 'Submit Answer' to see the result.</li>\n</ul>","question":"","hint":"<ul>\n<li>For the first pivot, use <code>.pivot()</code> on <code>users</code> with the <code>index</code> set to <code>'weekday'</code>, <code>columns</code> set to <code>'city'</code>, and <code>values</code> set to <code>'signups'</code>.</li>\n<li>For the second pivot, use <code>.pivot()</code> on <code>users</code>, specifying only the <code>index</code> and <code>columns</code> parameters as <code>'weekday'</code> and <code>'city'</code>.</li>\n</ul>","possible_answers":[],"number":4,"randomNumber":0.025375711651639765,"assignment":"<p>If you do not select any particular variables, all of them will be pivoted. In this case - with the <code>users</code> DataFrame - both <code>'visitors'</code> and <code>'signups'</code> will be pivoted, creating hierarchical column labels.</p>\n<p>You will explore this for yourself now in this exercise.</p>","feedbacks":[],"attachments":null,"title":"Pivoting all variables","xp":100,"language":"python","pre_exercise_code":"# pec\nimport pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename)\nusers = users.drop('Unnamed: 0', 1)","solution":"# Pivot users with signups indexed by weekday and city: signups_pivot\nsignups_pivot = users.pivot(index='weekday', columns='city', values='signups')\n\n# Print signups_pivot\nprint(signups_pivot)\n\n# Pivot users pivoted by both signups and visitors: pivot\npivot = users.pivot(index='weekday', columns='city')\n\n# Print the pivoted DataFrame\nprint(pivot)\n","type":"NormalExercise","id":44904},{"sample_code":"","sct":"","aspect_ratio":56.25,"instructions":null,"question":"","hint":null,"possible_answers":[],"number":5,"video_hls":"//videos.datacamp.com/transcoded/1650_pandas-2/v1/hls-ch3_2.master.m3u8","randomNumber":0.4399653178745524,"assignment":null,"feedbacks":[],"attachments":null,"title":"Stacking & unstacking DataFrames","xp":50,"language":"python","pre_exercise_code":"","solution":"","type":"VideoExercise","id":44905,"projector_key":"course_1650_11aaa1454a34b7fd7e311783179a3da3","video_link":null},{"sample_code":"# Unstack users by 'weekday': byweekday\nbyweekday = ____\n\n# Print the byweekday DataFrame\nprint(byweekday)\n\n# Stack byweekday by 'weekday' and print it\nprint(____)\n","sct":"test_correct(test_data_frame(\"byweekday\"),\n             test_function(\"users.unstack\"))\n\ntest_function(\"print\", index=1)\n\ntest_function(\"byweekday.stack\")\ntest_function(\"print\", index=2)\n\nsuccess_msg(\"Great work! By stacking and then unstacking `users`, you ended up with the same layout as the original DataFrame.\")","instructions":"<ul>\n<li>Define a DataFrame <code>byweekday</code> with the <code>'weekday'</code> level of <code>users</code> unstacked.</li>\n<li>Print the <code>byweekday</code> DataFrame to see the new data layout. This has been done for you.</li>\n<li>Stack <code>byweekday</code> by <code>'weekday'</code> and print it to check if you get the same layout as the original <code>users</code> DataFrame.</li>\n</ul>","question":"","hint":"<ul>\n<li>To unstack <code>users</code>, use <code>.unstack()</code> and specify the <code>level</code> parameter, which in this case, is <code>'weekday'</code>.</li>\n<li>To stack <code>byweekday</code>, use <code>.stack()</code> and specify <code>level='weekday'</code>.</li>\n</ul>","possible_answers":[],"number":6,"user":{"isHintShown":false,"rstudio":{"isReady":false,"settings":{},"showHistory":false,"cards":{"messages":[],"currentRow":0}},"editorTabs":{"files/script.py":{"title":"script.py","props":{"active":true,"isClosable":false,"code":"# Unstack users by 'weekday': byweekday\nbyweekday = ____\n\n# Print the byweekday DataFrame\nprint(byweekday)\n\n# Stack byweekday by 'weekday' and print it\nprint(____)\n","extra":{},"resetCode":"# Unstack users by 'weekday': byweekday\nbyweekday = ____\n\n# Print the byweekday DataFrame\nprint(byweekday)\n\n# Stack byweekday by 'weekday' and print it\nprint(____)\n"}}},"fileBrowser":{"sampleCode":{"fileSelected":null,"files":{"name":"files","isOpen":true,"children":[{"name":"script.py","initialContent":"# Unstack users by 'weekday': byweekday\nbyweekday = ____\n\n# Print the byweekday DataFrame\nprint(byweekday)\n\n# Stack byweekday by 'weekday' and print it\nprint(____)\n","content":"# Unstack users by 'weekday': byweekday\nbyweekday = ____\n\n# Print the byweekday DataFrame\nprint(byweekday)\n\n# Stack byweekday by 'weekday' and print it\nprint(____)\n","isClosable":false}]}},"solution":{"fileSelected":null,"files":{"name":"solution","isOpen":true,"children":[{"name":"solution.py","initialContent":"# Unstack users by 'weekday': byweekday\nbyweekday = users.unstack(level='weekday')\n\n# Print the byweekday DataFrame\nprint(byweekday)\n\n# Stack byweekday by 'weekday' and print it\nprint(byweekday.stack(level='weekday'))\n","content":"# Unstack users by 'weekday': byweekday\nbyweekday = users.unstack(level='weekday')\n\n# Print the byweekday DataFrame\nprint(byweekday)\n\n# Stack byweekday by 'weekday' and print it\nprint(byweekday.stack(level='weekday'))\n","isClosable":false}]}}},"outputMarkdownTabs":{},"markdown":{"titles":["Knit PDF","Knit HTML"],"activeTitle":"Knit HTML"},"currentXp":100,"graphicalTabs":{"plot":{"extraClass":"animation--flash","title":"Plots","props":{"sources":[],"currentIndex":0}},"html":{"extraClass":"animation--flash","title":"HTML Viewer","props":{"sources":[],"currentIndex":0}}},"feedbackMessages":[],"lastSubmittedCode":null,"ltiStatus":{},"lastSubmitActiveEditorTab":null,"consoleSqlTabs":{"query_result":{"extraClass":"","title":"query result","props":{"active":true,"isNotView":true,"message":"No query executed yet..."}}},"consoleTabs":{"console":{"title":"IPython Shell","props":{"active":true}},"slides":{"title":"Slides","props":{"active":false}}},"inputMarkdownTabs":{}},"randomNumber":0.21929476289967642,"assignment":"<p>You are now going to practice stacking and unstacking DataFrames. The <code>users</code> DataFrame you have been working with in this chapter has been pre-loaded for you, this time with a MultiIndex. Explore it in the IPython Shell to see the data layout. Pay attention to the index, and notice that the index levels are <code>['city', 'weekday']</code>. So <code>'weekday'</code> - the second entry - has position 1. This position is what corresponds to the <code>level</code> parameter in <code>.stack()</code> and <code>.unstack()</code> calls. Alternatively, you can specify <code>'weekday'</code> as the level instead of its position.</p>\n<p>Your job in this exercise is to unstack <code>users</code> by <code>'weekday'</code>. You will then use <code>.stack()</code> on the unstacked DataFrame to see if you get back the original layout of <code>users</code>.</p>","feedbacks":[],"attachments":null,"title":"Stacking & unstacking I","xp":100,"language":"python","pre_exercise_code":"# pec\nimport pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename).drop('Unnamed: 0', 1).set_index(['city', 'weekday']).sort_index()","solution":"# Unstack users by 'weekday': byweekday\nbyweekday = users.unstack(level='weekday')\n\n# Print the byweekday DataFrame\nprint(byweekday)\n\n# Stack byweekday by 'weekday' and print it\nprint(byweekday.stack(level='weekday'))\n","type":"NormalExercise","id":44906},{"sample_code":"# Unstack users by 'city': bycity\nbycity = ____\n\n# Print the bycity DataFrame\nprint(bycity)\n\n# Stack bycity by 'city' and print it\nprint(____)\n","sct":"test_correct(test_data_frame(\"bycity\"),\n             test_function(\"users.unstack\"))\n\ntest_function(\"print\", index=1)\n\ntest_function(\"bycity.stack\")\ntest_function(\"print\", index=2)\n\nsuccess_msg(\"Fantastic work! Hopefully this exercise and the previous one have developed your intuition for how stacking and unstacking work.\")","instructions":"<ul>\n<li>Define a DataFrame <code>bycity</code> with the <code>'city'</code> level of <code>users</code> unstacked.</li>\n<li>Print the <code>bycity</code> DataFrame to see the new data layout. This has been done for you.</li>\n<li>Stack <code>bycity</code> by <code>'city'</code> and print it to check if you get the same layout as the original <code>users</code> DataFrame.</li>\n</ul>","question":"","hint":"<ul>\n<li>To unstack <code>users</code>, use <code>.unstack()</code> and specify the <code>level</code> parameter, which in this case, is <code>'city'</code>.</li>\n<li>To stack <code>bycity</code>, use <code>.stack()</code> and specify <code>level='city'</code>.</li>\n</ul>","possible_answers":[],"number":7,"randomNumber":0.026228217811403054,"assignment":"<p>You are now going to continue working with the <code>users</code> DataFrame. As always, first explore it in the IPython Shell to see the layout and note the index.</p>\n<p>Your job in this exercise is to unstack and then stack the <code>'city'</code> level, as you did previously for <code>'weekday'</code>. Note that you won't get the same DataFrame.</p>","feedbacks":[],"attachments":null,"title":"Stacking & unstacking II","xp":100,"language":"python","pre_exercise_code":"# pec\nimport pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename).set_index(['city', 'weekday']).sort_index()\nusers = users.drop('Unnamed: 0', 1)","solution":"# Unstack users by 'city': bycity\nbycity = users.unstack(level='city')\n\n# Print the bycity DataFrame\nprint(bycity)\n\n# Stack bycity by 'city' and print it\nprint(bycity.stack(level='city'))\n","type":"NormalExercise","id":44907},{"sample_code":"# Stack 'city' back into the index of bycity: newusers\nnewusers = ____\n\n# Swap the levels of the index of newusers: newusers\nnewusers = ____\n\n# Print newusers and verify that the index is not sorted\nprint(newusers)\n\n# Sort the index of newusers: newusers\nnewusers = ____\n\n# Print newusers and verify that the index is now sorted\nprint(newusers)\n\n# Verify that the new DataFrame is equal to the original\nprint(newusers.equals(users))","sct":"test_correct(test_data_frame(\"newusers\"),\n             test_function(\"bycity.stack\"))\n\ntest_correct(test_data_frame(\"newusers\"),\n             test_function(\"newusers.swaplevel\"))\n\ntest_function(\"print\", index=1)\n\ntest_function(\"newusers.sort_index\")\n\ntest_function(\"print\", index=2)\n\ntest_function(\"newusers.equals\")\ntest_function(\"print\", index=3)\n\nsuccess_msg(\"Wonderful work! It's now time to learn about melting DataFrames!\")","instructions":"<ul>\n<li>Define a DataFrame <code>newusers</code> with the <code>'city'</code> level stacked back into the index of <code>bycity</code>.</li>\n<li>Swap the levels of the index of <code>newusers</code>. </li>\n<li>Print <code>newusers</code> and verify that the index is not sorted. This has been done for you.</li>\n<li>Sort the index of <code>newusers</code>.</li>\n<li>Print <code>newusers</code> and verify that the index is now sorted. This has been done for you.</li>\n<li>Assert that <code>newusers</code> equals <code>users</code>. This has been done for you, so hit 'Submit Answer' to see the result.</li>\n</ul>","question":"","hint":"<ul>\n<li>To create <code>newusers</code>, use <code>.stack()</code> on <code>bycity()</code> with the <code>level</code> parameter set to <code>'city'</code>. </li>\n<li>To swap the levels of the index of <code>newusers</code>, use <code>.swaplevel(0,1)</code>.</li>\n<li>To sort the index of <code>newusers</code>, use the <code>.sort_index()</code> method.</li>\n</ul>","possible_answers":[],"number":8,"randomNumber":0.20613591352204264,"assignment":"<p>Continuing from the previous exercise, you will now use <code>.swaplevel(0, 1)</code> to flip the index levels. Note they won't be sorted. To sort them, you will have to follow up with a <code>.sort_index()</code>. You will then obtain the original DataFrame. Note that an unsorted index leads to slicing failures.</p>\n<p>To begin, print both <code>users</code> and <code>bycity</code> in the IPython Shell. The goal here is to convert <code>bycity</code> back to something that looks like <code>users</code>.</p>","feedbacks":[],"attachments":null,"title":"Restoring the index order","xp":100,"language":"python","pre_exercise_code":"# pec\nimport pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename).drop('Unnamed: 0', 1).set_index(['city', 'weekday']).sort_index()\nbycity = users.unstack(level='city')","solution":"# Stack 'city' back into the index of bycity: newusers\nnewusers = bycity.stack(level='city')\n\n# Swap the levels of the index of newusers: newusers\nnewusers = newusers.swaplevel(0, 1)\n\n# Print newusers and verify that the index is not sorted\nprint(newusers)\n\n# Sort the index of newusers: newusers\nnewusers = newusers.sort_index()\n\n# Print newusers and verify that the index is now sorted\nprint(newusers)\n\n# Verify that the new DataFrame is equal to the original\nprint(newusers.equals(users))","type":"NormalExercise","id":44908},{"sample_code":"","sct":"","aspect_ratio":56.25,"instructions":null,"question":"","hint":null,"possible_answers":[],"number":9,"video_hls":"//videos.datacamp.com/transcoded/1650_pandas-2/v1/hls-ch3_3.master.m3u8","randomNumber":0.03100527674126119,"assignment":null,"feedbacks":[],"attachments":null,"title":"Melting DataFrames","xp":50,"language":"python","pre_exercise_code":"","solution":"","type":"VideoExercise","id":44909,"projector_key":"course_1650_7a654c416ba1153a8b13d4caf9d9f64a","video_link":null},{"sample_code":"# Reset the index: visitors_by_city_weekday\nvisitors_by_city_weekday = ____ \n\n# Print visitors_by_city_weekday\nprint(visitors_by_city_weekday)\n\n# Melt visitors_by_city_weekday: visitors\nvisitors = pd.melt(____, id_vars=____, value_name=____)\n\n# Print visitors\nprint(visitors)\n","sct":"test_correct(test_data_frame(\"visitors_by_city_weekday\"),\n             test_function(\"visitors_by_city_weekday.reset_index\"))\n\ntest_function(\"print\", index=1)\n\ntest_correct(test_data_frame(\"visitors\"),\n             test_function(\"pandas.melt\"))\n\ntest_function(\"print\", index=2)\n\nsuccess_msg(\"Well done! Notice how your melted DataFrame now has a `'city'` column with `Austin` and `Dallas` as its values. In the original DataFrame, they were columns themselves. Also note how specifying the `value_name` parameter has renamed the `'value'` column to `'visitors'`.\")\n","instructions":"<ul>\n<li>Reset the index of <code>visitors_by_city_weekday</code> with <code>.reset_index()</code>.</li>\n<li>Print <code>visitors_by_city_weekday</code> and verify that you have just a range index, 0, 1, 2, 3. This has been done for you.</li>\n<li>Melt <code>visitors_by_city_weekday</code> to move the city names from the column labels to values in a single column called <code>city</code>.</li>\n<li>Print <code>visitors</code> to check that the city values are in a single column now and that the dataframe is longer and skinnier. </li>\n</ul>","question":"","hint":"<ul>\n<li>To reset the index, just use the <code>.reset_index()</code> method on <code>visitors_by_city_weekday</code>.</li>\n<li>To melt the DataFrame, use <code>pd.melt()</code> with <code>visitors_by_city_weekday</code>, <code>id_vars=['weekday']</code> and <code>value_name='visitors'</code>.</li>\n</ul>","possible_answers":[],"number":10,"randomNumber":0.6584266539984527,"assignment":"<p>You are now going to practice melting DataFrames. A DataFrame called <code>visitors_by_city_weekday</code> has been pre-loaded for you. Explore it in the IPython Shell and see that it is the <code>users</code> DataFrame from previous exercises with the rows indexed by <code>'weekday'</code>, columns indexed by <code>'city'</code>, and values populated with <code>'visitors'</code>.</p>\n<p>Recall from the video that the goal of melting is to restore a pivoted DataFrame to its original form, or to change it from a wide shape to a long shape. You can explicitly specify the columns that should remain in the reshaped DataFrame with <code>id_vars</code>, and list which columns to convert into values with <code>value_vars</code>. As Dhavide demonstrated, if you don't pass a name to the values in <code>pd.melt()</code>, you will lose the name of your variable. You can fix this by using the <code>value_name</code> keyword argument. </p>\n<p>Your job in this exercise is to melt <code>visitors_by_city_weekday</code> to move the city names from the column labels to values in a single column called <code>'city'</code>. If you were to use just <code>pd.melt(visitors_by_city_weekday)</code>, you would obtain the following result:</p>\n<pre><code>      city value\n0  weekday   Mon\n1  weekday   Sun\n2   Austin   326\n3   Austin   139\n4   Dallas   456\n5   Dallas   237\n</code></pre>\n<p>Therefore, you have to specify the <code>id_vars</code> keyword argument to ensure that <code>'weekday'</code> is retained in the reshaped DataFrame, and the <code>value_name</code> keyword argument to change the name of <code>value</code> to <code>visitors</code>.</p>","feedbacks":[],"attachments":null,"title":"Adding names for readability","xp":100,"language":"python","pre_exercise_code":"# pec\nimport pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename)\nusers = users.drop('Unnamed: 0', 1)\nvisitors_by_city_weekday = users.pivot(index='weekday', columns='city', values='visitors')","solution":"# Reset the index: visitors_by_city_weekday\nvisitors_by_city_weekday = visitors_by_city_weekday.reset_index() \n\n# Print visitors_by_city_weekday\nprint(visitors_by_city_weekday)\n\n# Melt visitors_by_city_weekday: visitors\nvisitors = pd.melt(visitors_by_city_weekday, id_vars=['weekday'], value_name='visitors')\n\n# Print visitors\nprint(visitors)\n","type":"NormalExercise","id":44910},{"sample_code":"# Melt users: skinny\nskinny = ____\n\n# Print skinny\nprint(skinny)\n","sct":"test_correct(test_data_frame(\"skinny\"),\n             test_function(\"pandas.melt\"))\n\ntest_function(\"print\")\n\nsuccess_msg(\"Well done! Here, because you didn't specify the `var_name` or `value_name` parameters, the melted DataFrame has the default `variable` and `value` column names.\")\n","instructions":"<ul>\n<li>Define a DataFrame <code>skinny</code> where you melt the <code>'visitors'</code> and <code>'signups'</code> columns of <code>users</code> into a single column.</li>\n<li>Print <code>skinny</code> to verify the results. Note the <code>value</code> column that had the cell values in <code>users</code>.</li>\n</ul>","question":"","hint":"<p>Use <code>pd.melt()</code> to melt the <code>users</code> DataFrame, specify <code>id_vars=['weekday' ,'city']</code>.</p>","possible_answers":[],"number":11,"randomNumber":0.12952309799730255,"assignment":"<p>You can move multiple columns into a single column (making the data long and\nskinny) by \"melting\" multiple columns. In this exercise, you will practice doing this.</p>\n<p>The <code>users</code> DataFrame has been pre-loaded for you. As always, explore it in the IPython Shell and note the index.</p>","feedbacks":[],"attachments":null,"title":"Going from wide to long","xp":100,"language":"python","pre_exercise_code":"# pec\nimport pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename)\nusers = users.drop('Unnamed: 0', 1)\n#visitors_by_city_weekday = users.pivot(index='weekday', columns='weekday', values='city')","solution":"# Melt users: skinny\nskinny = pd.melt(users, id_vars=['weekday' ,'city'])\n\n# Print skinny\nprint(skinny)\n","type":"NormalExercise","id":44911},{"sample_code":"# Set the new index: users_idx\nusers_idx = ____\n\n# Print the users_idx DataFrame\nprint(users_idx)\n\n# Obtain the key-value pairs: kv_pairs\nkv_pairs = ____\n\n# Print the key-value pairs\nprint(kv_pairs)\n","sct":"test_correct(test_data_frame(\"users_idx\"),\n             test_function(\"users.set_index\"))\n\ntest_function(\"print\", index=1)\n\ntest_correct(test_data_frame(\"kv_pairs\"),\n             test_function(\"pandas.melt\"))\n\ntest_function(\"print\", index=2)\n\nsuccess_msg(\"Great work! It's always worth keeping in mind whether any aspects of your data lend themselves well to being represented as key-value pairs.\")\n","instructions":"<ul>\n<li>Set the index of <code>users</code> to <code>['city', 'weekday']</code>.</li>\n<li>Print the DataFrame <code>users_idx</code> to see the new index.</li>\n<li>Obtain the key-value pairs corresponding to visitors and signups by melting <code>users_idx</code> with the keyword argument <code>col_level=0</code>.</li>\n</ul>","question":"","hint":"<ul>\n<li>Use the <code>.set_index()</code> method on <code>users</code> with <code>['city', 'weekday']</code> as the argument to set its index.</li>\n<li>To obtain the key-value pairs, use <code>pd.melt()</code> with <code>users_idx</code> and <code>col_level=0</code>.</li>\n<li>Print the key-value pairs. This has been done for you, so hit 'Submit Answer' to see the result.</li>\n</ul>","possible_answers":[],"number":12,"randomNumber":0.015978641489175383,"assignment":"<p>Sometimes, all you need is some key-value pairs, and the context does not matter. If said context is in the index, you can easily obtain what you want. \nFor example, in the <code>users</code> DataFrame, the <code>visitors</code> and <code>signups</code> columns lend themselves well to being represented as key-value pairs. So if you created a hierarchical index with <code>'city'</code> and <code>'weekday'</code> columns as the index, you can easily extract key-value pairs for the <code>'visitors'</code> and <code>'signups'</code> columns by melting <code>users</code> and specifying <code>col_level=0</code>.</p>","feedbacks":[],"attachments":null,"title":"Obtaining key-value pairs with melt()","xp":100,"language":"python","pre_exercise_code":"import pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename)\nusers = users.drop('Unnamed: 0', 1)","solution":"# Set the new index: users_idx\nusers_idx = users.set_index(['city', 'weekday'])\n\n# Print the users_idx DataFrame\nprint(users_idx)\n\n# Obtain the key-value pairs: kv_pairs\nkv_pairs = pd.melt(users_idx, col_level=0)\n\n# Print the key-value pairs\nprint(kv_pairs)\n","type":"NormalExercise","id":44912},{"sample_code":"","sct":"","aspect_ratio":56.25,"instructions":null,"question":"","hint":null,"possible_answers":[],"number":13,"video_hls":"//videos.datacamp.com/transcoded/1650_pandas-2/v1/hls-ch3_4.master.m3u8","randomNumber":0.28598888637900877,"assignment":null,"feedbacks":[],"attachments":null,"title":"Pivot tables","xp":50,"language":"python","pre_exercise_code":"","solution":"","type":"VideoExercise","id":44913,"projector_key":"course_1650_932c8c4524090a0d415342d6a406a9b1","video_link":null},{"sample_code":"# Create the DataFrame with the appropriate pivot table: by_city_day\nby_city_day = ____\n\n# Print by_city_day\nprint(by_city_day)\n","sct":"test_correct(test_data_frame(\"by_city_day\"),\n             test_function(\"users.pivot_table\"))\n\ntest_function(\"print\")\n\nsuccess_msg(\"Excellent! Notice the labels of the index and the columns are `'weekday'` and `'city'`, respectively - exactly as you specified.\")","instructions":"<ul>\n<li>Use a pivot table to index the rows of <code>users</code> by <code>'weekday'</code> and the columns of <code>users</code> by <code>'city'</code>. These correspond to the <code>index</code> and <code>columns</code> parameters of <code>.pivot_table()</code>.</li>\n<li>Print <code>by_city_day</code>. This has been done for you, so hit 'Submit Answer' to see the result.</li>\n</ul>","question":"","hint":"<ul>\n<li>Use the <code>.pivot_table()</code> method on <code>users</code> with the <code>index</code> parameter set to <code>'weekday'</code> and the <code>'columns'</code> parameter set to <code>'city'</code>.</li>\n</ul>","possible_answers":[],"number":14,"randomNumber":0.8603510652695667,"assignment":"<p>Recall from the video that a pivot table allows you to see all of your variables as a function of two other variables. In this exercise, you will use the <code>.pivot_table()</code> method to see how the <code>users</code> DataFrame entries appear when presented as functions of the <code>'weekday'</code> and <code>'city'</code> columns. That is, with the rows indexed by <code>'weekday'</code> and the columns indexed by <code>'city'</code>.</p>\n<p>Before using the pivot table, print the <code>users</code> DataFrame in the IPython Shell and observe the layout.</p>","feedbacks":[],"attachments":null,"title":"Setting up a pivot table","xp":100,"language":"python","pre_exercise_code":"# pec\nimport pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename)\nusers = users.drop('Unnamed: 0', 1)","solution":"# Create the DataFrame with the appropriate pivot table: by_city_day\nby_city_day = users.pivot_table(index='weekday', columns='city')\n\n# Print by_city_day\nprint(by_city_day)\n","type":"NormalExercise","id":44914},{"sample_code":"# Use a pivot table to display the count of each column: count_by_weekday1\ncount_by_weekday1 = ____\n\n# Print count_by_weekday\nprint(count_by_weekday1)\n\n# Replace 'aggfunc='count'' with 'aggfunc=len': count_by_weekday2\ncount_by_weekday2 = ____\n\n# Verify that the same result is obtained\nprint('==========================================')\nprint(count_by_weekday1.equals(count_by_weekday2))\n","sct":"test_correct(test_data_frame(\"count_by_weekday1\"),\n             test_function(\"users.pivot_table\", index=1))\n\ntest_function(\"print\", index=1)\n\ntest_correct(test_data_frame(\"count_by_weekday2\"),\n             test_function(\"users.pivot_table\", index=2))\n\ntest_function(\"count_by_weekday1.equals\")\ntest_function(\"print\", index=3)\n\nsuccess_msg(\"Well done! As expected, both the `len` and `'count'` aggregation functions produced the same result.\")","instructions":"<ul>\n<li>Define a DataFrame <code>count_by_weekday1</code> that shows the count of each column with the parameter <code>aggfunc='count'</code>. The index here is <code>'weekday'</code>.</li>\n<li>Print <code>count_by_weekday1</code>. This has been done for you.</li>\n<li>Replace <code>aggfunc='count'</code> with <code>aggfunc=len</code> and verify you obtain the same result.</li>\n</ul>","question":"","hint":"<ul>\n<li>Use the <code>.pivot_table()</code> method on <code>users</code> with <code>index='weekday'</code> and the appropriate <code>aggfunc</code>.</li>\n</ul>","possible_answers":[],"number":15,"randomNumber":0.0041589496504421675,"assignment":"<p>You can also use aggregation functions with in a pivot table by specifying the <code>aggfunc</code> parameter. In this exercise, you will practice using the <code>'count'</code> and <code>len</code> aggregation functions - which produce the same result - on the <code>users</code> DataFrame.</p>","feedbacks":[],"attachments":null,"title":"Using other aggregations in pivot tables","xp":100,"language":"python","pre_exercise_code":"# pec\nimport pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename)\nusers = users.drop('Unnamed: 0', 1)","solution":"# Use a pivot table to display the count of each column: count_by_weekday1\ncount_by_weekday1 = users.pivot_table(index='weekday', aggfunc='count')\n\n# Print count_by_weekday\nprint(count_by_weekday1)\n\n# Replace 'aggfunc='count'' with 'aggfunc=len': count_by_weekday2\ncount_by_weekday2 = users.pivot_table(index='weekday', aggfunc=len)\n\n# Verify that the same result is obtained\nprint('==========================================')\nprint(count_by_weekday1.equals(count_by_weekday2))\n","type":"NormalExercise","id":44915},{"sample_code":"# Create the DataFrame with the appropriate pivot table: signups_and_visitors\nsignups_and_visitors = ____\n\n# Print signups_and_visitors\nprint(signups_and_visitors)\n\n# Add in the margins: signups_and_visitors_total \nsignups_and_visitors_total = ____\n\n# Print signups_and_visitors_total\nprint(signups_and_visitors_total)\n","sct":"test_correct(test_data_frame(\"signups_and_visitors\"),\n             test_function(\"users.pivot_table\", index=1))\n\ntest_function(\"print\", index=1)\n\ntest_correct(test_data_frame(\"signups_and_visitors_total\"),\n             test_function(\"users.pivot_table\", index=2))\n\ntest_function(\"print\", index=2)\n\nsuccess_msg(\"Fantastic! Take a look at how specifying `margins=True` resulted in the totals in each column being computed.\")","instructions":"<ul>\n<li>Define a DataFrame <code>signups_and_visitors</code> that shows the breakdown of signups and visitors by day, as well as the totals.<ul>\n<li>You will need to use <code>aggfunc=sum</code> to do this.</li></ul></li>\n<li>Print <code>signups_and_visitors</code>. This has been done for you.</li>\n<li>Now pass the additional argument <code>margins=True</code> to the <code>.pivot_table()</code> method to obtain the totals.</li>\n<li>Print <code>signups_and_visitors_total</code>. This has been done for you, so hit 'Submit Answer' to see the result.</li>\n</ul>","question":"","hint":"<p>For the first pivot table, you need to use the <code>.pivot_table()</code> method on users with <code>index='weekday'</code> and <code>aggfunc=sum</code>. For the second pivot table, you need to specify the additional <code>margins=True</code> parameter.</p>","possible_answers":[],"number":16,"randomNumber":0.5684693556856406,"assignment":"<p>Sometimes it's useful to add totals in the margins of a pivot table. You can do this with the argument <code>margins=True</code>. In this exercise, you will practice using margins in a pivot table along with a new aggregation function: <code>sum</code>.</p>\n<p>The <code>users</code> DataFrame, which you are now probably very familiar with, has been pre-loaded for you.</p>","feedbacks":[],"attachments":null,"title":"Using margins in pivot tables","xp":100,"language":"python","pre_exercise_code":"# pec\nimport pandas as pd\npath_root = 'https://s3.amazonaws.com/assets.datacamp.com/production/course_1650/datasets/'\nfilename = path_root + 'users.csv'\nusers = pd.read_csv(filename)\nusers = users.drop('Unnamed: 0', 1)","solution":"# Create the DataFrame with the appropriate pivot table: signups_and_visitors\nsignups_and_visitors = users.pivot_table(index='weekday', aggfunc=sum)\n\n# Print signups_and_visitors\nprint(signups_and_visitors)\n\n# Add in the margins: signups_and_visitors_total \nsignups_and_visitors_total = users.pivot_table(index='weekday', aggfunc=sum, margins=True)\n\n# Print signups_and_visitors_total\nprint(signups_and_visitors_total)\n","type":"NormalExercise","id":44916}]}};</script><script type="text/x-mathjax-config" data-reactid="34">
              MathJax && MathJax.Hub && MathJax.Hub.Config && MathJax.Hub.Config({
                messageStyle: "none"
              });
            </script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" data-reactid="35"></script><script src="/public/client-b95aa2621c56480d9efb.js" data-reactid="36"></script></body></html>